(self.webpackChunk=self.webpackChunk||[]).push([[7822],{99230:function(i,d,e){"use strict";e.r(d),e.d(d,{default:function(){return _}});var f=e(49677),y=e.n(f),v=e(15009),m=e.n(v),C=e(99289),h=e.n(C),L=e(12444),P=e.n(L),R=e(72004),j=e.n(R),Z=e(25098),H=e.n(Z),U=e(31996),O=e.n(U),X=e(26037),Y=e.n(X),N=e(9783),o=e.n(N),$=e(39318),g=e(61456),J=e(21990),V=e(40877),K=e(19632),z=e.n(K),A=e(18423),rt=e(5461),a=A.Z.Three,G=A.Z.TWEEN,Q=A.Z.dat,k=j()(function T(){var t=this;P()(this,T),o()(this,"container",void 0),o()(this,"camera",void 0),o()(this,"scene",void 0),o()(this,"renderer",void 0),o()(this,"animateFrame",void 0),o()(this,"starsGroup",void 0),o()(this,"pointsGroup",void 0),o()(this,"Geometrys",{}),o()(this,"Materials",{}),o()(this,"GuiInit",null),o()(this,"guiData",{x:.005,color:"#fafafa",autoRotate:!1}),o()(this,"mouseData",{mouseX:0,mouseY:0}),o()(this,"init",function(){t.container=document.getElementById("WebGL-points-test");var r=t.container.clientWidth,n=t.container.clientHeight;t.scene=new a.Scene,t.camera=new a.PerspectiveCamera(60,r/n,1,2e3),t.camera.position.x=0,t.camera.position.y=20,t.camera.position.z=500,t.camera.lookAt(t.scene.position),t.renderer=new a.WebGLRenderer,t.renderer.setPixelRatio(window.devicePixelRatio),t.renderer.setSize(r,n),t.container.appendChild(t.renderer.domElement),t.addThings(),t.addLight(),t.animate(),t.initEventListen(),t.initGui()}),o()(this,"destroy",function(){t.toggleGui(0),Object.values(t.Geometrys).forEach(function(r){r.dispose()}),Object.values(t.Materials).forEach(function(r){r.dispose()}),t.scene.clear(),t.renderer.dispose(),t.renderer.forceContextLoss(),t.camera=null,t.scene=null,t.renderer=null,t.GuiInit=null,cancelAnimationFrame(t.animateFrame)}),o()(this,"initGui",function(){if(t.GuiInit){t.toggleGui();return}t.GuiInit=new Q.GUI({}),t.GuiInit.domElement.style.position="absolute",t.GuiInit.domElement.style.right="10px",t.GuiInit.domElement.style.top="10px";var r=t.GuiInit.addFolder("\u63A7\u5236\u7A97\u53E3");r.add(t.guiData,"x",-.1,.1,.005).name("\u81EA\u8F6C\u901F\u5EA6"),r.addColor(t.guiData,"color").name("\u80CC\u666F\u989C\u8272"),r.open();var n=t.GuiInit.addFolder("stars position");n.add(t.starsGroup.position,"x",-500,500,1),n.add(t.starsGroup.position,"y",-500,500,1),n.add(t.starsGroup.position,"z",-500,500,1),n.open();var s=t.GuiInit.addFolder("stars rotation");s.add(t.guiData,"autoRotate").name("\u81EA\u52A8\u65CB\u8F6C"),s.add(t.starsGroup.rotation,"x",-3.14,3.14,.01),s.add(t.starsGroup.rotation,"y",-3.14,3.14,.01),s.add(t.starsGroup.rotation,"z",-3.14,3.14,.01),s.open()}),o()(this,"toggleGui",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(!(!t.GuiInit||!t.GuiInit.domElement)){var n=t.GuiInit.domElement.style.display=="none"?"":"none";r==0&&(n="none"),t.GuiInit.domElement.style.display=n}}),o()(this,"initEventListen",function(){t.container.addEventListener("pointermove",t.onPointerMove)}),o()(this,"onPointerMove",function(r){r.isPrimary!==!1&&(t.mouseData.mouseX=r.clientX-t.container.clientWidth,t.mouseData.mouseY=r.clientY-t.container.clientHeight)}),o()(this,"addLight",function(){}),o()(this,"addThings",function(){var r=new a.AxesHelper(800);t.scene.add(r),t.starsGroup=new a.Group,t.scene.add(t.starsGroup),t.Geometrys.starsGeometry=new a.BufferGeometry;for(var n=[],s=0;s<1e3;s++){var p=a.MathUtils.randFloatSpread(150),c=a.MathUtils.randFloatSpread(150),l=a.MathUtils.randFloatSpread(150);n.push(p,c,l)}t.Geometrys.starsGeometry.setAttribute("position",new a.Float32BufferAttribute(n,3)),t.Materials.starsMaterial=new a.PointsMaterial({color:16603607,size:1});var tt=new a.Points(t.Geometrys.starsGeometry,t.Materials.starsMaterial);t.starsGroup.add(tt);var F=new a.SphereGeometry(90,58,28);F.deleteAttribute("normal"),F.deleteAttribute("uv");var w=F.getAttribute("position");t.pointsGroup=new a.Group,t.scene.add(t.pointsGroup),t.Geometrys.pointsGeometry=new a.BufferGeometry;for(var nt=[],b=[],I=[],W=new a.Color,x=0;x<w.count;x++)b.push(Math.random()*15),W.setHSL(.01+.1*(x/400),.99,.25+.1*(x/400)),I=[].concat(z()(I),z()(W.toArray()));t.Geometrys.pointsGeometry.setAttribute("position",new a.Float32BufferAttribute(w.array,3)),t.Geometrys.pointsGeometry.setAttribute("size",new a.Float32BufferAttribute(b,1)),t.Geometrys.pointsGeometry.setAttribute("ca",new a.Float32BufferAttribute(I,3));var S=new a.TextureLoader().load("../../disc.png");S.wrapS=a.RepeatWrapping,S.wrapT=a.RepeatWrapping,t.Materials.pointsMaterial=new a.ShaderMaterial({uniforms:{color:{value:new a.Color(16777215)},pointTexture:{value:S}},vertexShader:`
        attribute float size;
        attribute vec3 ca;

        varying vec3 vColor;

        void main() {

          vColor = ca;

          vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

          gl_PointSize = size * ( 300.0 / -mvPosition.z );

          gl_Position = projectionMatrix * mvPosition;

        }
      `,fragmentShader:`
        uniform vec3 color;
        uniform sampler2D pointTexture;

        varying vec3 vColor;

        void main() {

          vec4 color = vec4( color * vColor, 1.0 ) * texture2D( pointTexture, gl_PointCoord );

          gl_FragColor = color;

        }
      `,transparent:!0});var et=new a.Points(t.Geometrys.pointsGeometry,t.Materials.pointsMaterial);t.pointsGroup.add(et),console.log("geometry",w,t.Geometrys.starsGeometry,t.Geometrys.pointsGeometry),t.initTween()}),o()(this,"initTween",function(){var r=new G.Tween(t.starsGroup.position).to({y:12,z:300},1e3).start();r.easing(G.Easing.Circular.Out);var n=new G.Tween(t.pointsGroup.position).to({y:12,z:300},1e3).delay(500);n.easing(G.Easing.Circular.Out),n.start()}),o()(this,"animate",function(){t.animateFrame=requestAnimationFrame(t.animate),t.render(),G.update()}),o()(this,"render",function(){t.renderer.setClearColor(t.guiData.color,1),t.guiData.autoRotate&&(t.starsGroup.rotation.y+=.015);var r=Date.now()*.005;t.pointsGroup.rotation.y=t.guiData.x*r,t.pointsGroup.rotation.z=t.guiData.x*r;for(var n=t.Geometrys.pointsGeometry.attributes,s=0;s<n.size.array.length;s++)n.size.array[s]=10+6*Math.sin(.1*s+r);n.size.needsUpdate=!0,t.renderer.render(t.scene,t.camera)})}),q=new k,D=q,u=e(85893),M=g.Z.Title,E=g.Z.Paragraph,B=g.Z.Text,_=function(T){O()(r,T);var t=Y()(r);function r(){var n;P()(this,r);for(var s=arguments.length,p=new Array(s),c=0;c<s;c++)p[c]=arguments[c];return n=t.call.apply(t,[this].concat(p)),o()(H()(n),"state",{}),n}return j()(r,[{key:"didShow",value:function(){var n=h()(m()().mark(function p(){return m()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:case"end":return l.stop()}},p)}));function s(){return n.apply(this,arguments)}return s}()},{key:"didMount",value:function(){var n=h()(m()().mark(function p(){return m()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:D.init();case 1:case"end":return l.stop()}},p)}));function s(){return n.apply(this,arguments)}return s}()},{key:"willUnmount",value:function(){D.destroy()}},{key:"render",value:function(){return y()(this.state),(0,u.jsxs)(J.Z,{title:"",children:[(0,u.jsx)(V.Z,{}),(0,u.jsxs)(g.Z,{children:[(0,u.jsx)(M,{children:"\u7C92\u5B50\u7CFB\u7EDF"}),(0,u.jsx)(E,{children:(0,u.jsx)("p",{children:"\u901A\u8FC7Points\u6216\u8005Sprite\u7C7B\u6765\u5B9E\u73B0"})}),(0,u.jsx)(M,{level:3,children:"PointsMaterial"}),(0,u.jsx)(E,{children:(0,u.jsx)(B,{children:"\u5C31\u662FPoints\u7C7B\u4F7F\u7528\u7684\u6750\u8D28"})}),(0,u.jsx)(M,{level:3,children:"\u6570\u5B66\u5E93"}),(0,u.jsx)(E,{children:(0,u.jsx)(B,{children:"randFloatSpread ( range : Float ) : Float - \u5728\u533A\u95F4 [- range / 2, range / 2] \u5185\u968F\u673A\u4E00\u4E2A\u6D6E\u70B9\u6570\u3002"})})]}),(0,u.jsx)("div",{id:"WebGL-points-test",style:{width:"600px",height:"600px"}})]})}}]),r}($.Z)},96446:function(i,d,e){var f=e(37923);function y(v){if(Array.isArray(v))return f(v)}i.exports=y,i.exports.__esModule=!0,i.exports.default=i.exports},96936:function(i){function d(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}i.exports=d,i.exports.__esModule=!0,i.exports.default=i.exports},88619:function(i){function d(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}i.exports=d,i.exports.__esModule=!0,i.exports.default=i.exports},19632:function(i,d,e){var f=e(96446),y=e(96936),v=e(96263),m=e(88619);function C(h){return f(h)||y(h)||v(h)||m()}i.exports=C,i.exports.__esModule=!0,i.exports.default=i.exports}}]);
