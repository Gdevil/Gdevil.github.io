(self.webpackChunk=self.webpackChunk||[]).push([[2805],{79991:function(d,v,i){"use strict";i.r(v),i.d(v,{default:function(){return ft}});var G=i(49677),E=i.n(G),f=i(15009),y=i.n(f),D=i(99289),g=i.n(D),J=i(12444),L=i.n(J),$=i(72004),j=i.n($),K=i(25098),k=i.n(K),q=i(31996),_=i.n(q),tt=i(26037),et=i.n(tt),nt=i(9783),n=i.n(nt),at=i(39318),w=i(61456),it=i(21990),rt=i(40877),ot=i(19632),O=i.n(ot),h=i(18423),gt=i(5461),m=h.Z.Three,F=h.Z.TWEEN,st=h.Z.dat,ut=h.Z.Stats,lt=j()(function A(){var t=this;L()(this,A),n()(this,"container",void 0),n()(this,"camera",void 0),n()(this,"scene",void 0),n()(this,"renderer",void 0),n()(this,"stats",void 0),n()(this,"loader",void 0),n()(this,"tween",void 0),n()(this,"animateFrame",void 0),n()(this,"particleSystem",void 0),n()(this,"Geometrys",{}),n()(this,"Materials",{}),n()(this,"GuiInit",null),n()(this,"guiData",{color:"#ffffff",mouseMove:!1,autoRotate:!0,SEPARATION:100,AMOUNTX:50,AMOUNTY:50,positionYBase:50}),n()(this,"mouseData",{mouseX:0,mouseY:0}),n()(this,"init",function(){t.container=document.getElementById("WebGL-points-cpu");var e=t.container.clientWidth,a=t.container.clientHeight;t.scene=new m.Scene,t.camera=new m.PerspectiveCamera(40,e/a,1,1e4),t.camera.position.z=150,t.camera.lookAt(t.scene.position),t.renderer=new m.WebGLRenderer,t.renderer.setPixelRatio(window.devicePixelRatio),t.renderer.setSize(e,a),t.container.appendChild(t.renderer.domElement),t.loader=new m.ObjectLoader,t.addThings(),t.addLight(),t.animate(),t.initEventListen(),t.initStats(),t.initGui()}),n()(this,"destroy",function(){t.toggleGui(0),Object.values(t.Geometrys).forEach(function(e){e.dispose()}),Object.values(t.Materials).forEach(function(e){e.dispose()}),t.scene.clear(),t.renderer.dispose(),t.renderer.forceContextLoss(),t.camera=null,t.scene=null,t.renderer=null,t.GuiInit=null,cancelAnimationFrame(t.animateFrame),t.tween.stop(),t.tween=null}),n()(this,"initGui",function(){if(t.GuiInit){t.toggleGui();return}t.GuiInit=new st.GUI({}),t.GuiInit.domElement.style.position="absolute",t.GuiInit.domElement.style.right="10px",t.GuiInit.domElement.style.top="10px";var e=t.GuiInit.addFolder("\u63A7\u5236\u7A97\u53E3");e.open()}),n()(this,"initStats",function(){t.stats=new ut,t.stats.showPanel(0),t.stats.dom.style.position="absolute",t.container.appendChild(t.stats.dom)}),n()(this,"toggleGui",function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(!(!t.GuiInit||!t.GuiInit.domElement)){var a=t.GuiInit.domElement.style.display=="none"?"":"none";e==0&&(a="none"),t.GuiInit.domElement.style.display=a}}),n()(this,"initEventListen",function(){t.container.addEventListener("pointermove",t.onPointerMove)}),n()(this,"onPointerMove",function(e){e.isPrimary!==!1&&(t.mouseData.mouseX=e.clientX-t.container.clientWidth,t.mouseData.mouseY=e.clientY-t.container.clientHeight)}),n()(this,"addLight",function(){var e=new m.DirectionalLight(16777215);e.position.set(0,200,0),t.scene.add(e)}),n()(this,"addThings",function(){var e,a,o;t.loader.load("../../static/teapot-claraio.json",function(r){console.log("teapot-claraio",r),e=r,e&&a&&!o&&(o=!0,t.addPartice(e,a))}),t.loader.load("../../static/head-edited.json",function(r){console.log("head-edited",r),a=r,e&&a&&!o&&(o=!0,t.addPartice(e,a))})}),n()(this,"addPartice",function(e,a){console.log("???",e,a);var o,r;e.geometry.attributes.position.array.length>a.geometry.attributes.position.array.length?(o=e,r=a):(o=a,r=e);var l=[],c=[],I=o.geometry.attributes.position.array.length,z=r.geometry.attributes.position.array.length;l=O()(o.geometry.attributes.position.array),c=O()(r.geometry.attributes.position.array);for(var T=z,P=0;T<I;T++,P++)c.push(c[P]);t.particleSystem=new m.Group;var H=new m.TextureLoader().load("../../dot.png");t.Geometrys.starsGeometry=new m.BufferGeometry,t.Geometrys.starsGeometry.setAttribute("position",new m.Float32BufferAttribute(l,3));var x=new m.PointsMaterial({color:65280,size:2,map:H,blending:m.CustomBlending,depthTest:!1,transparent:!0}),M=new m.Points(t.Geometrys.starsGeometry,x);t.particleSystem.add(M);var S={val:1};t.tween=new F.Tween(S).to({val:0},2e3).easing(F.Easing.Quadratic.InOut).delay(1e3).onUpdate(b);var p=new F.Tween(S).to({val:1},2e3).easing(F.Easing.Quadratic.InOut).delay(1e3).onUpdate(b);t.tween.chain(p),p.chain(t.tween),t.tween.start();var R=t;function b(U){for(var V=U.val,Q=[],B=0;B<l.length;B++){var yt=l[B]*V+c[B]*(1-V);Q.push(yt)}R.Geometrys.starsGeometry.setAttribute("position",new m.Float32BufferAttribute(Q,3))}t.scene.add(t.particleSystem)}),n()(this,"initTween",function(){}),n()(this,"animate",function(){t.stats&&t.stats.begin(),t.render(),F.update(),t.stats&&t.stats.end(),t.animateFrame=requestAnimationFrame(t.animate)}),n()(this,"render",function(){t.guiData.autoRotate&&t.particleSystem&&(t.particleSystem.rotation.y+=.005),t.guiData.mouseMove&&(t.camera.position.x+=(-t.mouseData.mouseX-t.camera.position.x)*.015,t.camera.position.y+=(-t.mouseData.mouseY-t.camera.position.y)*.015),t.renderer.render(t.scene,t.camera)})}),dt=new lt,X=dt,xt=i(5461),u=h.Z.Three,C=h.Z.TWEEN,ct=h.Z.dat,mt=h.Z.Stats,vt=j()(function A(){var t=this;L()(this,A),n()(this,"container",void 0),n()(this,"camera",void 0),n()(this,"scene",void 0),n()(this,"renderer",void 0),n()(this,"stats",void 0),n()(this,"loader",void 0),n()(this,"tween",void 0),n()(this,"animateFrame",void 0),n()(this,"particleSystem",void 0),n()(this,"Geometrys",{}),n()(this,"Materials",{}),n()(this,"GuiInit",null),n()(this,"guiData",{color:"#ffffff",mouseMove:!1,autoRotate:!0,SEPARATION:100,AMOUNTX:50,AMOUNTY:50,positionYBase:50}),n()(this,"mouseData",{mouseX:0,mouseY:0}),n()(this,"init",function(){t.container=document.getElementById("WebGL-points-gpu");var e=t.container.clientWidth,a=t.container.clientHeight;t.scene=new u.Scene,t.camera=new u.PerspectiveCamera(40,e/a,1,1e4),t.camera.position.z=150,t.camera.lookAt(t.scene.position),t.renderer=new u.WebGLRenderer,t.renderer.setPixelRatio(window.devicePixelRatio),t.renderer.setSize(e,a),t.container.appendChild(t.renderer.domElement),t.loader=new u.ObjectLoader,t.addThings(),t.addLight(),t.animate(),t.initEventListen(),t.initStats(),t.initGui()}),n()(this,"destroy",function(){t.toggleGui(0),Object.values(t.Geometrys).forEach(function(e){e.dispose()}),Object.values(t.Materials).forEach(function(e){e.dispose()}),t.scene.clear(),t.renderer.dispose(),t.renderer.forceContextLoss(),t.camera=null,t.scene=null,t.renderer=null,t.GuiInit=null,cancelAnimationFrame(t.animateFrame),t.particleSystem=null,t.tween.stop(),t.tween=null}),n()(this,"initGui",function(){if(t.GuiInit){t.toggleGui();return}t.GuiInit=new ct.GUI({}),t.GuiInit.domElement.style.position="absolute",t.GuiInit.domElement.style.right="10px",t.GuiInit.domElement.style.top="10px";var e=t.GuiInit.addFolder("\u63A7\u5236\u7A97\u53E3");e.open()}),n()(this,"initStats",function(){t.stats=new mt,t.stats.showPanel(0),t.stats.dom.style.position="absolute",t.container.appendChild(t.stats.dom)}),n()(this,"toggleGui",function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(!(!t.GuiInit||!t.GuiInit.domElement)){var a=t.GuiInit.domElement.style.display=="none"?"":"none";e==0&&(a="none"),t.GuiInit.domElement.style.display=a}}),n()(this,"initEventListen",function(){t.container.addEventListener("pointermove",t.onPointerMove)}),n()(this,"onPointerMove",function(e){e.isPrimary!==!1&&(t.mouseData.mouseX=e.clientX-t.container.clientWidth,t.mouseData.mouseY=e.clientY-t.container.clientHeight)}),n()(this,"addLight",function(){var e=new u.DirectionalLight(16777215);e.position.set(0,200,0),t.scene.add(e)}),n()(this,"addThings",function(){var e,a,o;t.loader.load("../../static/teapot-claraio.json",function(r){console.log("teapot-claraio",r),e=r,e&&a&&!o&&(o=!0,t.addPartice(e,a))}),t.loader.load("../../static/cpmovie-edit.json",function(r){console.log("cpmovie-edit",r),r.rotation.x=Math.PI/2,a=r,e&&a&&!o&&(o=!0,t.addPartice(e,a))})}),n()(this,"addPartice",function(e,a){console.log("???",e,a);var o,r;e.geometry.attributes.position.array.length>a.geometry.attributes.position.array.length?(o=e,r=a):(o=a,r=e);var l=[],c=[],I=o.geometry.attributes.position.array.length,z=r.geometry.attributes.position.array.length;l=o.geometry.attributes.position.array,c=O()(r.geometry.attributes.position.array);for(var T=z,P=0;T<I;T++,P++)c.push(c[P]);var H=new u.Vector3(1,1,1),x=new u.Matrix4;x.makeRotationX(Math.PI/2),x.multiply(new u.Matrix4().makeScale(2,2,2)),x.multiply(new u.Matrix4().makeTranslation(30,0,-10));for(var M=[],S=new u.Color,p=0;p<I/3;p++)M.push(4),S.setHSL(.01+.1*(p/400),.99,.25+.1*(p/400));t.particleSystem=new u.Group,t.Geometrys.starsGeometry=new u.BufferGeometry;var R=new u.TextureLoader().load("../../dot.png"),b={color:{value:new u.Color(16777215)},pointTexture:{value:R},val:{value:1}};t.Materials.starsMaterial=new u.ShaderMaterial({uniforms:b,vertexShader:`
        attribute float size;
        attribute vec3 position2;
        uniform float val;
        varying vec3 vPos;

        void main() {

          vPos.x = position.x * val + position2.x * (1.-val);
          vPos.y = position.y* val + position2.y * (1.-val);
          vPos.z = position.z* val + position2.z * (1.-val);

          vec4 mvPosition = modelViewMatrix * vec4( vPos, 1.0 );

          gl_PointSize = size * ( 300.0 / -mvPosition.z );

          gl_Position = projectionMatrix * mvPosition;

        }
      `,fragmentShader:`
        uniform vec3 color;
        uniform sampler2D pointTexture;

        varying vec3 vPos;

        void main() {

          vec3 vColor = vec3(1.0, 0., 0.);
          vColor.r = vPos.z/50.;
          vColor.g = vPos.y/50.;
          vColor.b = vPos.x/50.;

          gl_FragColor = vec4( color * vColor, 1.0 );

          gl_FragColor = gl_FragColor * texture2D( pointTexture, gl_PointCoord );

        }
      `,blending:u.AdditiveBlending,depthTest:!1,transparent:!0}),t.Geometrys.starsGeometry.setAttribute("size",new u.Float32BufferAttribute(M,1)),t.Geometrys.starsGeometry.setAttribute("position",new u.Float32BufferAttribute(l,3)),t.Geometrys.starsGeometry.setAttribute("position2",new u.Float32BufferAttribute(c,3));var U=new u.Points(t.Geometrys.starsGeometry,t.Materials.starsMaterial);t.particleSystem.add(U),t.particleSystem.position.y=-15,t.Geometrys.starsGeometry.applyMatrix4(x),t.scene.add(t.particleSystem),t.initTween()}),n()(this,"initTween",function(){var e={val:1};t.tween=new C.Tween(e).to({val:0},3e3).easing(C.Easing.Quadratic.InOut).delay(2e3).onUpdate(r);var a=new C.Tween(e).to({val:1},3e3).easing(C.Easing.Quadratic.InOut).delay(2e3).onUpdate(r);t.tween.chain(a),a.chain(t.tween),t.tween.start();var o=t;function r(l){o.Materials.starsMaterial.uniforms.val.value=l.val}}),n()(this,"animate",function(){t.stats&&t.stats.begin(),t.render(),C.update(),t.stats&&t.stats.end(),t.animateFrame=requestAnimationFrame(t.animate)}),n()(this,"render",function(){t.guiData.mouseMove&&(t.camera.position.x+=(-t.mouseData.mouseX-t.camera.position.x)*.015,t.camera.position.y+=(-t.mouseData.mouseY-t.camera.position.y)*.015);var e=Date.now()*.005;if(t.particleSystem){var a=t.Geometrys.starsGeometry;t.particleSystem.rotation.y=.01*e;for(var o=a.attributes.size.array,r=o.length,l=0;l<r;l++)o[l]=2*(1+Math.sin(.02*l+e));t.Geometrys.starsGeometry.setAttribute("size",new u.Float32BufferAttribute(o,1))}t.renderer.render(t.scene,t.camera)})}),ht=new vt,N=ht,Y=i(45670),s=i(85893),W=w.Z.Title,Z=w.Z.Paragraph,pt=w.Z.Text,ft=function(A){_()(e,A);var t=et()(e);function e(){var a;L()(this,e);for(var o=arguments.length,r=new Array(o),l=0;l<o;l++)r[l]=arguments[l];return a=t.call.apply(t,[this].concat(r)),n()(k()(a),"state",{}),a}return j()(e,[{key:"didShow",value:function(){var a=g()(y()().mark(function r(){return y()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:case"end":return c.stop()}},r)}));function o(){return a.apply(this,arguments)}return o}()},{key:"didMount",value:function(){var a=g()(y()().mark(function r(){return y()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:X.init(),N.init();case 2:case"end":return c.stop()}},r)}));function o(){return a.apply(this,arguments)}return o}()},{key:"willUnmount",value:function(){X.destroy(),N.destroy()}},{key:"render",value:function(){return E()(this.state),(0,s.jsxs)(it.Z,{title:"",children:[(0,s.jsx)(rt.Z,{}),(0,s.jsxs)(w.Z,{children:[(0,s.jsx)(W,{children:"\u7C92\u5B50\u8FD0\u52A8"}),(0,s.jsx)(Z,{children:(0,s.jsxs)("p",{children:["\u53C2\u8003\uFF1A",(0,s.jsx)("a",{href:"https://www.cnblogs.com/wanbo/p/6869175.html",children:"https://www.cnblogs.com/wanbo/p/6869175.html"})]})}),(0,s.jsx)(W,{level:3,children:"1\u3001\u57FA\u4E8ECPU"}),(0,s.jsx)(Z,{})]}),(0,s.jsx)("div",{className:Y.Z.canvasBox,id:"WebGL-points-cpu",style:{height:"600px"}}),(0,s.jsxs)(w.Z,{style:{marginTop:60},children:[(0,s.jsx)(W,{level:3,children:"2\u3001\u57FA\u4E8EGPU"}),(0,s.jsxs)(Z,{children:[(0,s.jsxs)("p",{children:["\u8FD9\u91CC\u7528\u5230\u4E86\u4E00\u4E2A\u77E9\u9635\u8F6C\u6362\uFF0C\u7528\u6CD5\uFF1A(\u4F46\u662F\u5982\u679C\u662F\u9488\u5BF9\u6BCF\u4E00\u4E2A\u9876\u70B9\u5FAA\u73AF\u8FDB\u884C\u8F6C\u6362\u7684\u8BDD\uFF0C\u4F1A\u5F88\u8017\u65F6\u3002\u53EF\u4EE5\u7528",(0,s.jsx)(pt,{code:!0,children:"applyMatrix"}),"\u64CD\u4F5C\u6574\u4E2A\u6A21\u578B)"]}),(0,s.jsxs)("div",{className:"codeBox",children:[(0,s.jsx)("p",{children:"const vector = new Three.Vector3(1,1,1);   //\u65B0\u5EFA\u4E00\u4E2A\u4E09\u7EF4\u5411\u91CF"}),(0,s.jsx)("p",{children:"const matrix = new Three.Matrix4();   //\u65B0\u5EFA\u4E00\u4E2A4*4\u77E9\u9635"}),(0,s.jsx)("p",{children:"// matrix.makeRotationX(Math.PI/2)  //\u8FD9\u662F\u4E00\u4E2A rotateX=90\xB0 \u7684\u77E9\u9635"}),(0,s.jsx)("p",{children:"matrix.makeTranslation(2,0,0)  //\u8FD9\u662F\u4E00\u4E2A tranxlateX=2 \u7684\u77E9\u9635"}),(0,s.jsx)("p",{children:"let changedVector = vector.applyMatrix4(matrix)  //\u8FD0\u7B97\uFF0C\u4E09\u7EF4\u5411\u91CF*\u77E9\u9635"}),(0,s.jsx)("p",{children:"console.log('Matrix::::', vector, matrix, changedVector)  //\u5F97\u5230\u7684changedVector\u5C31\u662F\u8F6C\u6362\u540E\u7684\u5750\u6807\u70B9"})]})]})]}),(0,s.jsx)("div",{className:Y.Z.canvasBox,id:"WebGL-points-gpu",style:{height:"600px"}})]})}}]),e}(at.Z)},96446:function(d,v,i){var G=i(37923);function E(f){if(Array.isArray(f))return G(f)}d.exports=E,d.exports.__esModule=!0,d.exports.default=d.exports},96936:function(d){function v(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}d.exports=v,d.exports.__esModule=!0,d.exports.default=d.exports},88619:function(d){function v(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}d.exports=v,d.exports.__esModule=!0,d.exports.default=d.exports},19632:function(d,v,i){var G=i(96446),E=i(96936),f=i(96263),y=i(88619);function D(g){return G(g)||E(g)||f(g)||y()}d.exports=D,d.exports.__esModule=!0,d.exports.default=d.exports}}]);
